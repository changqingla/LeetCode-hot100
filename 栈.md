# æ ˆä¸“é¢˜

## ğŸ” æ ˆåŸºç¡€çŸ¥è¯†

### ğŸ“– å®šä¹‰

**æ ˆ**ï¼ˆStackï¼‰æ˜¯ä¸€ç§éµå¾ª**åè¿›å…ˆå‡º**ï¼ˆLast In First Out, LIFOï¼‰åŸåˆ™çš„æ•°æ®ç»“æ„ã€‚æ ˆåªå…è®¸åœ¨æ ˆé¡¶è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œã€‚

### âš¡ æ ¸å¿ƒç‰¹å¾

1. **åè¿›å…ˆå‡º**ï¼šæœ€åå…¥æ ˆçš„å…ƒç´ æœ€å…ˆå‡ºæ ˆ
2. **å•ç‚¹æ“ä½œ**ï¼šåªèƒ½åœ¨æ ˆé¡¶è¿›è¡Œpushå’Œpopæ“ä½œ
3. **é€’å½’æ¨¡æ‹Ÿ**ï¼šæ ˆå¸¸ç”¨äºæ¨¡æ‹Ÿé€’å½’è¿‡ç¨‹

### ğŸ¯ è§£é¢˜åº”ç”¨åœºæ™¯

1. **æ‹¬å·åŒ¹é…**ï¼šä½¿ç”¨æ ˆåŒ¹é…å„ç§æ‹¬å·
2. **è¡¨è¾¾å¼æ±‚å€¼**ï¼šé€†æ³¢å…°è¡¨è¾¾å¼ã€ä¸­ç¼€è½¬åç¼€
3. **å•è°ƒæ ˆ**ï¼šæ‰¾åˆ°ä¸‹ä¸€ä¸ªæ›´å¤§/æ›´å°å…ƒç´ 
4. **DFSå®ç°**ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢çš„æ ˆå®ç°
5. **å‡½æ•°è°ƒç”¨**ï¼šç³»ç»Ÿæ ˆæ¨¡æ‹Ÿé€’å½’è°ƒç”¨

### ğŸ Pythonæ ˆå®ç°

```python
# ä½¿ç”¨åˆ—è¡¨ä½œä¸ºæ ˆ
stack = []

# åŸºæœ¬æ“ä½œ
stack.append(1)    # å…¥æ ˆ push
stack.append(2)
top = stack[-1]    # æŸ¥çœ‹æ ˆé¡¶ top
element = stack.pop()  # å‡ºæ ˆ pop

# è¾…åŠ©æ–¹æ³•
is_empty = len(stack) == 0  # åˆ¤æ–­æ ˆç©º
size = len(stack)           # è·å–æ ˆå¤§å°

# collections.dequeå®ç°ï¼ˆæ•ˆç‡æ›´é«˜ï¼‰
from collections import deque
stack = deque()
stack.append(1)
stack.pop()
```

### ğŸ“ å•è°ƒæ ˆ

**å•è°ƒæ ˆ**æ˜¯æŒ‡æ ˆå†…å…ƒç´ ä¿æŒå•è°ƒé€’å¢æˆ–å•è°ƒé€’å‡çš„æ ˆç»“æ„ã€‚

```python
# å•è°ƒé€’å¢æ ˆï¼šæ ˆå†…å…ƒç´ ä¸¥æ ¼é€’å¢
def monotonic_increasing_stack(nums):
    stack = []
    for i, num in enumerate(nums):
        while stack and nums[stack[-1]] >= num:  # >= æˆ– > å–å†³äºæ˜¯å¦å…è®¸ç›¸ç­‰
            stack.pop()
        stack.append(i)
    return stack

# å•è°ƒé€’å‡æ ˆï¼šæ ˆå†…å…ƒç´ ä¸¥æ ¼é€’å‡
def monotonic_decreasing_stack(nums):
    stack = []
    for i, num in enumerate(nums):
        while stack and nums[stack[-1]] <= num:  # <= æˆ– < å–å†³äºæ˜¯å¦å…è®¸ç›¸ç­‰
            stack.pop()
        stack.append(i)
    return stack
```

---

## ğŸ“‹ é¢˜ç›®ç›®å½•

| é¢˜å· | é¢˜ç›®åç§° | éš¾åº¦ | æ ¸å¿ƒæŠ€å·§ |
|------|----------|------|----------|
| 20 | æœ‰æ•ˆçš„æ‹¬å· | ç®€å• | æ ˆåŒ¹é… |
| 155 | æœ€å°æ ˆ | ä¸­ç­‰ | åŒæ ˆè®¾è®¡ |
| 394 | å­—ç¬¦ä¸²è§£ç  | ä¸­ç­‰ | æ ˆå¤„ç†åµŒå¥— |
| 739 | æ¯æ—¥æ¸©åº¦ | ä¸­ç­‰ | å•è°ƒæ ˆ |
| 84 | æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢ | å›°éš¾ | å•è°ƒæ ˆ |

---

## 20. æœ‰æ•ˆçš„æ‹¬å·

**é¢˜ç›®æè¿°ï¼š**

ç»™å®šä¸€ä¸ªåªåŒ…æ‹¬ `'('`ï¼Œ`')'`ï¼Œ`'{'`ï¼Œ`'}'`ï¼Œ`'['`ï¼Œ`']'` çš„å­—ç¬¦ä¸² `s` ï¼Œåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆã€‚

æœ‰æ•ˆå­—ç¬¦ä¸²éœ€æ»¡è¶³ï¼š
- å·¦æ‹¬å·å¿…é¡»ç”¨ç›¸åŒç±»å‹çš„å³æ‹¬å·é—­åˆã€‚
- å·¦æ‹¬å·å¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºé—­åˆã€‚
- æ¯ä¸ªå³æ‹¬å·éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ç›¸åŒç±»å‹çš„å·¦æ‹¬å·ã€‚

**æµ‹è¯•ç”¨ä¾‹ï¼š**

```
ç¤ºä¾‹ 1ï¼š
è¾“å…¥ï¼šs = "()"
è¾“å‡ºï¼štrue

ç¤ºä¾‹ 2ï¼š
è¾“å…¥ï¼šs = "()[]{}"
è¾“å‡ºï¼štrue

ç¤ºä¾‹ 3ï¼š
è¾“å…¥ï¼šs = "(]"
è¾“å‡ºï¼šfalse

ç¤ºä¾‹ 4ï¼š
è¾“å…¥ï¼šs = "([])"
è¾“å‡ºï¼štrue

ç¤ºä¾‹ 5ï¼š
è¾“å…¥ï¼šs = "([)]"
è¾“å‡ºï¼šfalse
```

**æœ€ç®€å•å®ç°ï¼š**

```python
def isValid(s):
    """
    æœ‰æ•ˆçš„æ‹¬å·ï¼šä½¿ç”¨æ ˆè¿›è¡ŒåŒ¹é…
    
    æ€è·¯ï¼š
    1. åˆ›å»ºæ‹¬å·æ˜ å°„ï¼šå³æ‹¬å· -> å·¦æ‹¬å·
    2. éå†å­—ç¬¦ä¸²ï¼š
       - é‡åˆ°å·¦æ‹¬å·ï¼Œå…¥æ ˆ
       - é‡åˆ°å³æ‹¬å·ï¼Œæ£€æŸ¥æ ˆé¡¶æ˜¯å¦åŒ¹é…
    3. æœ€åæ ˆåº”è¯¥ä¸ºç©º
    
    æ—¶é—´å¤æ‚åº¦ï¼šO(n)
    ç©ºé—´å¤æ‚åº¦ï¼šO(n)
    """
    # æ‹¬å·æ˜ å°„ï¼šå³æ‹¬å· -> å·¦æ‹¬å·
    bracket_map = {
        ')': '(',
        '}': '{',
        ']': '['
    }
    
    stack = []
    
    for char in s:
        if char in bracket_map:
            # å³æ‹¬å·ï¼šæ£€æŸ¥æ ˆæ˜¯å¦ä¸ºç©ºä¸”æ ˆé¡¶æ˜¯å¦åŒ¹é…
            if not stack or stack[-1] != bracket_map[char]:
                return False
            stack.pop()  # åŒ¹é…æˆåŠŸï¼Œå‡ºæ ˆ
        else:
            # å·¦æ‹¬å·ï¼šå…¥æ ˆ
            stack.append(char)
    
    # æ ˆä¸ºç©ºè¯´æ˜æ‰€æœ‰æ‹¬å·éƒ½åŒ¹é…
    return len(stack) == 0

# æµ‹è¯•ç”¨ä¾‹
print(isValid("()"))        # è¾“å‡º: True
print(isValid("()[]{}"))    # è¾“å‡º: True
print(isValid("(]"))        # è¾“å‡º: False
print(isValid("([])"))      # è¾“å‡º: True
print(isValid("([)]"))      # è¾“å‡º: False
```

**è§£é¢˜æ€è·¯è¯¦è§£ï¼š**

è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯ä½¿ç”¨**æ ˆè¿›è¡Œæ‹¬å·åŒ¹é…**ï¼š

**æ ¸å¿ƒåŸç†ï¼š**
- å·¦æ‹¬å·å…¥æ ˆï¼Œå³æ‹¬å·å‡ºæ ˆåŒ¹é…
- é‡åˆ°å³æ‹¬å·æ—¶ï¼Œæ ˆé¡¶å¿…é¡»æ˜¯å¯¹åº”çš„å·¦æ‹¬å·
- æœ€ç»ˆæ ˆå¿…é¡»ä¸ºç©º

**ç®—æ³•æµç¨‹ï¼š**
1. åˆ›å»ºæ‹¬å·æ˜ å°„ï¼šå³æ‹¬å·æ˜ å°„åˆ°å¯¹åº”çš„å·¦æ‹¬å·
2. åˆå§‹åŒ–ç©ºæ ˆ
3. éå†å­—ç¬¦ä¸²ï¼š
   - å¦‚æœæ˜¯å·¦æ‹¬å·ï¼Œå…¥æ ˆ
   - å¦‚æœæ˜¯å³æ‹¬å·ï¼š
     - æ ˆä¸ºç©ºæˆ–æ ˆé¡¶ä¸åŒ¹é…ï¼Œè¿”å›False
     - åŒ¹é…æˆåŠŸï¼Œå‡ºæ ˆ
4. éå†ç»“æŸåï¼Œæ ˆä¸ºç©ºè¿”å›Trueï¼Œå¦åˆ™False

**ä¸¾ä¾‹è¯´æ˜ï¼š**
```
s = "([])"

éå†è¿‡ç¨‹ï¼š
'(' â†’ å…¥æ ˆï¼Œstack = ['(']
'[' â†’ å…¥æ ˆï¼Œstack = ['(', '[']
']' â†’ å³æ‹¬å·ï¼Œæ ˆé¡¶'['åŒ¹é…ï¼Œå¼¹å‡ºï¼Œstack = ['(']
')' â†’ å³æ‹¬å·ï¼Œæ ˆé¡¶'('åŒ¹é…ï¼Œå¼¹å‡ºï¼Œstack = []

æ ˆä¸ºç©ºï¼Œè¿”å›True âœ“
```

**ä¸¾ä¾‹è¯´æ˜ï¼ˆé”™è¯¯æƒ…å†µï¼‰ï¼š**
```
s = "([)]"

éå†è¿‡ç¨‹ï¼š
'(' â†’ å…¥æ ˆï¼Œstack = ['(']
'[' â†’ å…¥æ ˆï¼Œstack = ['(', '[']
')' â†’ å³æ‹¬å·ï¼Œæ ˆé¡¶'['åŒ¹é…ï¼Œå¼¹å‡ºï¼Œstack = ['(']
']' â†’ å³æ‹¬å·ï¼Œæ ˆé¡¶'('ä¸åŒ¹é…'['ï¼Œè¿”å›False âœ—
```

**æ—¶é—´å¤æ‚åº¦è¯æ˜ï¼š**
- éå†ä¸€æ¬¡å­—ç¬¦ä¸²ï¼šO(n)
- æ ˆæ“ä½œï¼šO(1)
- æ€»å¤æ‚åº¦ï¼šO(n)

---

## 155. æœ€å°æ ˆ

**é¢˜ç›®æè¿°ï¼š**

è®¾è®¡ä¸€ä¸ªæ”¯æŒ `push` ï¼Œ`pop` ï¼Œ`top` æ“ä½œï¼Œå¹¶èƒ½åœ¨å¸¸æ•°æ—¶é—´å†…æ£€ç´¢åˆ°æœ€å°å…ƒç´ çš„æ ˆã€‚

å®ç° `MinStack` ç±»:
- `MinStack()` åˆå§‹åŒ–å †æ ˆå¯¹è±¡ã€‚
- `void push(int val)` å°†å…ƒç´ valæ¨å…¥å †æ ˆã€‚
- `void pop()` åˆ é™¤å †æ ˆé¡¶éƒ¨çš„å…ƒç´ ã€‚
- `int top()` è·å–å †æ ˆé¡¶éƒ¨çš„å…ƒç´ ã€‚
- `int getMin()` è·å–å †æ ˆä¸­çš„æœ€å°å…ƒç´ ã€‚

**æµ‹è¯•ç”¨ä¾‹ï¼š**

```
ç¤ºä¾‹ 1ï¼š
è¾“å…¥ï¼š
["MinStack","push","push","push","getMin","pop","top","getMin"]
[[],[-2],[0],[-3],[],[],[],[]]

è¾“å‡ºï¼š
[null,null,null,null,-3,null,0,-2]

è§£é‡Šï¼š
MinStack minStack = new MinStack();
minStack.push(-2);
minStack.push(0);
minStack.push(-3);
minStack.getMin();   // --> è¿”å› -3.
minStack.pop();
minStack.top();      // --> è¿”å› 0.
minStack.getMin();   // --> è¿”å› -2.
```

**æœ€ç®€å•å®ç°ï¼š**

```python
class MinStack:
    """
    æœ€å°æ ˆï¼šä½¿ç”¨è¾…åŠ©æ ˆå­˜å‚¨æœ€å°å€¼
    
    æ€è·¯ï¼š
    1. ä½¿ç”¨ä¸¤ä¸ªæ ˆï¼šä¸»æ ˆå­˜å‚¨æ•°æ®ï¼Œè¾…åŠ©æ ˆå­˜å‚¨æœ€å°å€¼
    2. pushæ—¶ï¼šä¸»æ ˆå…¥æ ˆï¼Œè¾…åŠ©æ ˆå…¥æ ˆå½“å‰æœ€å°å€¼
    3. popæ—¶ï¼šä¸¤ä¸ªæ ˆåŒæ—¶å‡ºæ ˆ
    4. getMinæ—¶ï¼šè¿”å›è¾…åŠ©æ ˆæ ˆé¡¶
    
    æ—¶é—´å¤æ‚åº¦ï¼šO(1) æ‰€æœ‰æ“ä½œ
    ç©ºé—´å¤æ‚åº¦ï¼šO(n)
    """

    def __init__(self):
        self.stack = []      # ä¸»æ ˆï¼šå­˜å‚¨å®é™…æ•°æ®
        self.min_stack = []  # è¾…åŠ©æ ˆï¼šå­˜å‚¨æœ€å°å€¼

    def push(self, val: int) -> None:
        self.stack.append(val)
        # è¾…åŠ©æ ˆå…¥æ ˆå½“å‰æœ€å°å€¼
        if not self.min_stack or val <= self.min_stack[-1]:
            self.min_stack.append(val)
        else:
            self.min_stack.append(self.min_stack[-1])

    def pop(self) -> None:
        if self.stack:
            self.stack.pop()
            self.min_stack.pop()

    def top(self) -> int:
        return self.stack[-1] if self.stack else None

    def getMin(self) -> int:
        return self.min_stack[-1] if self.min_stack else None

# æµ‹è¯•ç”¨ä¾‹
minStack = MinStack()
minStack.push(-2)
minStack.push(0)
minStack.push(-3)
print(minStack.getMin())  # è¾“å‡º: -3
minStack.pop()
print(minStack.top())     # è¾“å‡º: 0
print(minStack.getMin())  # è¾“å‡º: -2
```

**ä¼˜åŒ–ç‰ˆæœ¬ï¼ˆèŠ‚çœç©ºé—´ï¼‰ï¼š**

```python
class MinStackOptimized:
    """
    ä¼˜åŒ–ç‰ˆæœ¬ï¼šè¾…åŠ©æ ˆåªå­˜å‚¨ä¸¥æ ¼é€’å‡çš„æœ€å°å€¼
    
    æ€è·¯ï¼š
    1. è¾…åŠ©æ ˆåªåœ¨é‡åˆ°æ›´å°çš„å€¼æ—¶æ‰å…¥æ ˆ
    2. å‡ºæ ˆæ—¶ï¼Œåªæœ‰å½“ä¸»æ ˆå‡ºæ ˆçš„å€¼ç­‰äºè¾…åŠ©æ ˆæ ˆé¡¶æ—¶ï¼Œæ‰å¼¹å‡ºè¾…åŠ©æ ˆ
    3. è¿™æ ·å¯ä»¥èŠ‚çœä¸€äº›ç©ºé—´
    
    æ—¶é—´å¤æ‚åº¦ï¼šO(1) æ‰€æœ‰æ“ä½œ
    ç©ºé—´å¤æ‚åº¦ï¼šO(n) æœ€åæƒ…å†µä¸‹ä»ä¸ºO(n)
    """

    def __init__(self):
        self.stack = []
        self.min_stack = []

    def push(self, val: int) -> None:
        self.stack.append(val)
        # åªæœ‰å½“valå°äºç­‰äºå½“å‰æœ€å°å€¼æ—¶ï¼Œæ‰å…¥æ ˆ
        if not self.min_stack or val <= self.min_stack[-1]:
            self.min_stack.append(val)

    def pop(self) -> None:
        if self.stack:
            val = self.stack.pop()
            # åªæœ‰å½“å¼¹å‡ºçš„å€¼ç­‰äºæœ€å°å€¼æ—¶ï¼Œæ‰å¼¹å‡ºè¾…åŠ©æ ˆ
            if val == self.min_stack[-1]:
                self.min_stack.pop()

    def top(self) -> int:
        return self.stack[-1] if self.stack else None

    def getMin(self) -> int:
        return self.min_stack[-1] if self.min_stack else None
```

**è§£é¢˜æ€è·¯è¯¦è§£ï¼š**

è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯ä½¿ç”¨**åŒæ ˆè®¾è®¡**ï¼š

**æ ¸å¿ƒåŸç†ï¼š**
- ä¸»æ ˆå­˜å‚¨å®é™…æ•°æ®
- è¾…åŠ©æ ˆå­˜å‚¨å†å²æœ€å°å€¼
- ä¿è¯è¾…åŠ©æ ˆæ ˆé¡¶å§‹ç»ˆæ˜¯å½“å‰æ ˆä¸­çš„æœ€å°å€¼

**æ–¹æ³•ä¸€ï¼šåŒæ­¥æ›´æ–°**
- pushæ—¶ï¼šä¸»æ ˆå…¥æ ˆï¼Œè¾…åŠ©æ ˆå…¥æ ˆå½“å‰æœ€å°å€¼
- popæ—¶ï¼šä¸¤ä¸ªæ ˆåŒæ—¶å‡ºæ ˆ
- getMinæ—¶ï¼šç›´æ¥è¿”å›è¾…åŠ©æ ˆæ ˆé¡¶

**æ–¹æ³•äºŒï¼šä¼˜åŒ–ç©ºé—´**
- è¾…åŠ©æ ˆåªå­˜å‚¨ä¸¥æ ¼é€’å‡çš„æœ€å°å€¼åºåˆ—
- pushæ—¶ï¼šåªæœ‰å½“æ–°å€¼ â‰¤ å½“å‰æœ€å°å€¼æ—¶ï¼Œæ‰å…¥è¾…åŠ©æ ˆ
- popæ—¶ï¼šåªæœ‰å½“å¼¹å‡ºçš„å€¼ç­‰äºè¾…åŠ©æ ˆæ ˆé¡¶æ—¶ï¼Œæ‰å¼¹å‡ºè¾…åŠ©æ ˆ

**ä¸¾ä¾‹è¯´æ˜ï¼ˆæ–¹æ³•ä¸€ï¼‰ï¼š**
```
push(-2):
ä¸»æ ˆ: [-2], è¾…åŠ©æ ˆ: [-2]

push(0):
ä¸»æ ˆ: [-2, 0], è¾…åŠ©æ ˆ: [-2, -2]  (0 > -2ï¼Œé‡å¤å…¥æ ˆ-2)

push(-3):
ä¸»æ ˆ: [-2, 0, -3], è¾…åŠ©æ ˆ: [-2, -2, -3]  (-3 < -2ï¼Œå…¥æ ˆ-3)

getMin(): è¿”å›-3 âœ“

pop():
ä¸»æ ˆ: [-2, 0], è¾…åŠ©æ ˆ: [-2, -2]

top(): è¿”å›0
getMin(): è¿”å›-2 âœ“
```

**æ—¶é—´å¤æ‚åº¦è¯æ˜ï¼š**
- æ‰€æœ‰æ“ä½œéƒ½æ˜¯O(1)
- pushå’Œpopéƒ½åªæ¶‰åŠå¸¸æ•°æ¬¡æ ˆæ“ä½œ

---

## 394. å­—ç¬¦ä¸²è§£ç 

**é¢˜ç›®æè¿°ï¼š**

ç»™å®šä¸€ä¸ªç»è¿‡ç¼–ç çš„å­—ç¬¦ä¸²ï¼Œè¿”å›å®ƒè§£ç åçš„å­—ç¬¦ä¸²ã€‚

ç¼–ç è§„åˆ™ä¸º: `k[encoded_string]`ï¼Œè¡¨ç¤ºå…¶ä¸­æ–¹æ‹¬å·å†…éƒ¨çš„ `encoded_string` æ­£å¥½é‡å¤ `k` æ¬¡ã€‚æ³¨æ„ `k` ä¿è¯ä¸ºæ­£æ•´æ•°ã€‚

ä½ å¯ä»¥è®¤ä¸ºè¾“å…¥å­—ç¬¦ä¸²æ€»æ˜¯æœ‰æ•ˆçš„ï¼›è¾“å…¥å­—ç¬¦ä¸²ä¸­æ²¡æœ‰é¢å¤–çš„ç©ºæ ¼ï¼Œä¸”è¾“å…¥çš„æ–¹æ‹¬å·æ€»æ˜¯ç¬¦åˆæ ¼å¼è¦æ±‚çš„ã€‚

æ­¤å¤–ï¼Œä½ å¯ä»¥è®¤ä¸ºåŸå§‹æ•°æ®ä¸åŒ…å«æ•°å­—ï¼Œæ‰€æœ‰çš„æ•°å­—åªè¡¨ç¤ºé‡å¤çš„æ¬¡æ•° `k` ï¼Œä¾‹å¦‚ä¸ä¼šå‡ºç°åƒ `3a` æˆ– `2[4]` çš„è¾“å…¥ã€‚

**æµ‹è¯•ç”¨ä¾‹ï¼š**

```
ç¤ºä¾‹ 1ï¼š
è¾“å…¥ï¼šs = "3[a]2[bc]"
è¾“å‡ºï¼š"aaabcbc"

ç¤ºä¾‹ 2ï¼š
è¾“å…¥ï¼šs = "3[a2[c]]"
è¾“å‡ºï¼š"accaccacc"

ç¤ºä¾‹ 3ï¼š
è¾“å…¥ï¼šs = "2[abc]3[cd]ef"
è¾“å‡ºï¼š"abcabccdcdcdef"

ç¤ºä¾‹ 4ï¼š
è¾“å…¥ï¼šs = "abc3[cd]xyz"
è¾“å‡ºï¼š"abccdcdcdxyz"
```

**æœ€ç®€å•å®ç°ï¼š**

```python
def decodeString(s):
    """
    å­—ç¬¦ä¸²è§£ç ï¼šä½¿ç”¨æ ˆå¤„ç†åµŒå¥—ç»“æ„
    
    æ€è·¯ï¼š
    1. ä½¿ç”¨ä¸¤ä¸ªæ ˆï¼šä¸€ä¸ªå­˜æ•°å­—ï¼Œä¸€ä¸ªå­˜å­—ç¬¦ä¸²
    2. é‡åˆ°æ•°å­—ï¼šè§£æå®Œæ•´æ•°å­—ï¼Œå…¥æ•°å­—æ ˆ
    3. é‡åˆ°'['ï¼šå½“å‰å­—ç¬¦ä¸²å…¥å­—ç¬¦ä¸²æ ˆï¼Œå¼€å¯æ–°çš„å­—ç¬¦ä¸²
    4. é‡åˆ°å­—æ¯ï¼šç´¯ç§¯åˆ°å½“å‰å­—ç¬¦ä¸²
    5. é‡åˆ°']'ï¼šå¼¹å‡ºæ•°å­—å’Œå­—ç¬¦ä¸²ï¼Œè¿›è¡Œé‡å¤æ‹¼æ¥
    
    æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå…¶ä¸­næ˜¯è§£ç åå­—ç¬¦ä¸²çš„é•¿åº¦
    ç©ºé—´å¤æ‚åº¦ï¼šO(n)
    """
    num_stack = []    # å­˜å‚¨æ•°å­—
    str_stack = []    # å­˜å‚¨å­—ç¬¦ä¸²
    current_str = ""  # å½“å‰æ„å»ºçš„å­—ç¬¦ä¸²
    current_num = 0   # å½“å‰è§£æçš„æ•°å­—
    
    for char in s:
        if char.isdigit():
            # è§£ææ•°å­—ï¼ˆå¯èƒ½å¤šä½ï¼‰
            current_num = current_num * 10 + int(char)
        elif char == '[':
            # é‡åˆ°å·¦æ‹¬å·ï¼šä¿å­˜å½“å‰çŠ¶æ€
            num_stack.append(current_num)
            str_stack.append(current_str)
            current_num = 0
            current_str = ""
        elif char == ']':
            # é‡åˆ°å³æ‹¬å·ï¼šè¿›è¡Œé‡å¤
            num = num_stack.pop()
            prev_str = str_stack.pop()
            # é‡å¤å½“å‰å­—ç¬¦ä¸²numæ¬¡
            current_str = prev_str + current_str * num
        else:
            # å­—æ¯ï¼šç´¯ç§¯åˆ°å½“å‰å­—ç¬¦ä¸²
            current_str += char
    
    return current_str

# æµ‹è¯•ç”¨ä¾‹
print(decodeString("3[a]2[bc]"))        # è¾“å‡º: "aaabcbc"
print(decodeString("3[a2[c]]"))         # è¾“å‡º: "accaccacc"
print(decodeString("2[abc]3[cd]ef"))    # è¾“å‡º: "abcabccdcdcdef"
print(decodeString("abc3[cd]xyz"))      # è¾“å‡º: "abccdcdcdxyz"
```

**è§£é¢˜æ€è·¯è¯¦è§£ï¼š**

è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯ä½¿ç”¨**æ ˆå¤„ç†åµŒå¥—ç»“æ„**ï¼š

**æ ¸å¿ƒåŸç†ï¼š**
- ä½¿ç”¨æ ˆæ¥å¤„ç†åµŒå¥—çš„é‡å¤ç»“æ„
- é‡åˆ°`[`æ—¶ä¿å­˜å½“å‰çŠ¶æ€ï¼Œå¼€å¯æ–°å±‚çº§
- é‡åˆ°`]`æ—¶å¼¹å‡ºå¹¶é‡å¤æ‹¼æ¥

**ç®—æ³•æµç¨‹ï¼š**
1. åˆå§‹åŒ–ä¸¤ä¸ªæ ˆï¼šnum_stackå­˜æ•°å­—ï¼Œstr_stackå­˜å­—ç¬¦ä¸²
2. åˆå§‹åŒ–current_strå’Œcurrent_num
3. éå†å­—ç¬¦ä¸²ï¼š
   - æ•°å­—ï¼šç´¯ç§¯åˆ°current_num
   - `[`ï¼šä¿å­˜çŠ¶æ€åˆ°æ ˆï¼Œå¼€å¯æ–°å­—ç¬¦ä¸²
   - å­—æ¯ï¼šç´¯ç§¯åˆ°current_str
   - `]`ï¼šå¼¹å‡ºæ•°å­—å’Œå­—ç¬¦ä¸²ï¼Œè¿›è¡Œé‡å¤æ‹¼æ¥
4. è¿”å›æœ€ç»ˆçš„current_str

**ä¸¾ä¾‹è¯´æ˜ï¼š**
```
s = "3[a2[c]]"

éå†è¿‡ç¨‹ï¼š
'3' â†’ current_num = 3
'[' â†’ num_stack=[3], str_stack=[""], current_str=""
'a' â†’ current_str = "a"
'2' â†’ current_num = 2
'[' â†’ num_stack=[3,2], str_stack=["","a"], current_str=""
'c' â†’ current_str = "c"
']' â†’ num=2, prev_str="a", current_str = "a" + "c"*2 = "acc"
']' â†’ num=3, prev_str="", current_str = "" + "acc"*3 = "accaccacc"

æœ€ç»ˆç»“æœï¼š"accaccacc" âœ“
```

**æ—¶é—´å¤æ‚åº¦åˆ†æï¼š**
- éå†è¾“å…¥å­—ç¬¦ä¸²ï¼šO(n)
- å­—ç¬¦ä¸²é‡å¤æ“ä½œï¼šO(m)ï¼Œå…¶ä¸­mæ˜¯è¾“å‡ºé•¿åº¦
- æ€»å¤æ‚åº¦ï¼šO(m)ï¼Œmæ˜¯è§£ç åå­—ç¬¦ä¸²çš„é•¿åº¦

---

## 739. æ¯æ—¥æ¸©åº¦

**é¢˜ç›®æè¿°ï¼š**

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `temperatures` ï¼Œè¡¨ç¤ºæ¯å¤©çš„æ¸©åº¦ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ `answer` ï¼Œå…¶ä¸­ `answer[i]` æ˜¯æŒ‡å¯¹äºç¬¬ `i` å¤©ï¼Œä¸‹ä¸€ä¸ªæ›´é«˜æ¸©åº¦å‡ºç°åœ¨å‡ å¤©åã€‚å¦‚æœæ°”æ¸©åœ¨è¿™ä¹‹åéƒ½ä¸ä¼šå‡é«˜ï¼Œè¯·åœ¨è¯¥ä½ç½®ç”¨ `0` æ¥ä»£æ›¿ã€‚

**æµ‹è¯•ç”¨ä¾‹ï¼š**

```
ç¤ºä¾‹ 1ï¼š
è¾“å…¥: temperatures = [73,74,75,71,69,72,76,73]
è¾“å‡º: [1,1,4,2,1,1,0,0]

ç¤ºä¾‹ 2ï¼š
è¾“å…¥: temperatures = [30,40,50,60]
è¾“å‡º: [1,1,1,0]

ç¤ºä¾‹ 3ï¼š
è¾“å…¥: temperatures = [30,60,90]
è¾“å‡º: [1,1,0]
```

**æœ€ç®€å•å®ç°ï¼š**

```python
def dailyTemperatures(temperatures):
    """
    æ¯æ—¥æ¸©åº¦ï¼šä½¿ç”¨å•è°ƒæ ˆ
    
    æ€è·¯ï¼š
    1. ä½¿ç”¨å•è°ƒé€’å‡æ ˆï¼Œå­˜å‚¨ç´¢å¼•
    2. éå†æ¸©åº¦æ•°ç»„ï¼š
       - å¦‚æœå½“å‰æ¸©åº¦ > æ ˆé¡¶æ¸©åº¦ï¼Œè¯´æ˜æ‰¾åˆ°äº†æ›´é«˜æ¸©åº¦
       - è®¡ç®—å¤©æ•°å·®ï¼Œæ›´æ–°ç­”æ¡ˆ
       - å‡ºæ ˆï¼Œç»§ç»­æ£€æŸ¥
    3. å½“å‰æ¸©åº¦å…¥æ ˆ
    
    æ—¶é—´å¤æ‚åº¦ï¼šO(n)
    ç©ºé—´å¤æ‚åº¦ï¼šO(n)
    """
    n = len(temperatures)
    answer = [0] * n
    stack = []  # å•è°ƒé€’å‡æ ˆï¼Œå­˜å‚¨ç´¢å¼•
    
    for i in range(n):
        # å½“æ ˆä¸ä¸ºç©ºä¸”å½“å‰æ¸©åº¦ > æ ˆé¡¶æ¸©åº¦
        while stack and temperatures[i] > temperatures[stack[-1]]:
            prev_index = stack.pop()
            answer[prev_index] = i - prev_index
        
        # å½“å‰ç´¢å¼•å…¥æ ˆ
        stack.append(i)
    
    return answer

# æµ‹è¯•ç”¨ä¾‹
print(dailyTemperatures([73,74,75,71,69,72,76,73]))  # è¾“å‡º: [1,1,4,2,1,1,0,0]
print(dailyTemperatures([30,40,50,60]))               # è¾“å‡º: [1,1,1,0]
print(dailyTemperatures([30,60,90]))                  # è¾“å‡º: [1,1,0]
```

**è§£é¢˜æ€è·¯è¯¦è§£ï¼š**

è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯ä½¿ç”¨**å•è°ƒæ ˆ**ï¼š

**æ ¸å¿ƒåŸç†ï¼š**
- å•è°ƒé€’å‡æ ˆç»´æŠ¤æ¸©åº¦é€’å‡çš„ç´¢å¼•åºåˆ—
- å½“é‡åˆ°æ›´é«˜æ¸©åº¦æ—¶ï¼Œæ ˆå†…æ‰€æœ‰æ›´ä½æ¸©åº¦éƒ½èƒ½æ‰¾åˆ°ç­”æ¡ˆ
- æ ˆå†…å…ƒç´ ä»æ ˆåº•åˆ°æ ˆé¡¶æ¸©åº¦ä¸¥æ ¼é€’å‡

**ç®—æ³•æµç¨‹ï¼š**
1. åˆå§‹åŒ–answeræ•°ç»„ä¸º0ï¼Œå•è°ƒæ ˆ
2. éå†æ¸©åº¦æ•°ç»„ï¼š
   - å½“æ ˆä¸ä¸ºç©ºä¸”å½“å‰æ¸©åº¦ > æ ˆé¡¶æ¸©åº¦ï¼š
     - å¼¹å‡ºæ ˆé¡¶ç´¢å¼•ï¼Œè®¡ç®—å¤©æ•°å·®
     - æ›´æ–°answer[prev_index]
   - å½“å‰ç´¢å¼•å…¥æ ˆ
3. è¿”å›answer

**ä¸¾ä¾‹è¯´æ˜ï¼š**
```
temperatures = [73,74,75,71,69,72,76,73]

i=0: 73å…¥æ ˆï¼Œstack=[0]
i=1: 74 > 73ï¼Œå¼¹å‡º0ï¼Œanswer[0]=1-0=1ï¼Œ74å…¥æ ˆï¼Œstack=[1]
i=2: 75 > 74ï¼Œå¼¹å‡º1ï¼Œanswer[1]=2-1=1ï¼Œ75å…¥æ ˆï¼Œstack=[2]
i=3: 71 < 75ï¼Œ71å…¥æ ˆï¼Œstack=[2,3]
i=4: 69 < 71ï¼Œ69å…¥æ ˆï¼Œstack=[2,3,4]
i=5: 72 > 69ï¼Œå¼¹å‡º4ï¼Œanswer[4]=5-4=1
     72 > 71ï¼Œå¼¹å‡º3ï¼Œanswer[3]=5-3=2
     72 < 75ï¼Œ72å…¥æ ˆï¼Œstack=[2,5]
i=6: 76 > 72ï¼Œå¼¹å‡º5ï¼Œanswer[5]=6-5=1
     76 > 75ï¼Œå¼¹å‡º2ï¼Œanswer[2]=6-2=4
     76å…¥æ ˆï¼Œstack=[6]
i=7: 73 < 76ï¼Œ73å…¥æ ˆï¼Œstack=[6,7]

æœ€ç»ˆç»“æœï¼š[1,1,4,2,1,1,0,0] âœ“
```

**æ—¶é—´å¤æ‚åº¦è¯æ˜ï¼š**
- æ¯ä¸ªå…ƒç´ æœ€å¤šå…¥æ ˆå‡ºæ ˆä¸€æ¬¡ï¼šO(n)
- æ€»å¤æ‚åº¦ï¼šO(n)

---

## 84. æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢

**é¢˜ç›®æè¿°ï¼š**

ç»™å®š `n` ä¸ªéè´Ÿæ•´æ•°ï¼Œç”¨æ¥è¡¨ç¤ºæŸ±çŠ¶å›¾ä¸­å„ä¸ªæŸ±å­çš„é«˜åº¦ã€‚æ¯ä¸ªæŸ±å­å½¼æ­¤ç›¸é‚»ï¼Œä¸”å®½åº¦ä¸º `1` ã€‚

æ±‚åœ¨è¯¥æŸ±çŠ¶å›¾ä¸­ï¼Œèƒ½å¤Ÿå‹¾å‹’å‡ºæ¥çš„çŸ©å½¢çš„æœ€å¤§é¢ç§¯ã€‚

![æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢ç¤ºæ„å›¾](./imgs/84.png)

**æµ‹è¯•ç”¨ä¾‹ï¼š**

```
è¾“å…¥ï¼šheights = [2,1,5,6,2,3]
è¾“å‡ºï¼š10
è§£é‡Šï¼šæœ€å¤§çš„çŸ©å½¢ä¸ºç¬¬3åˆ°ç¬¬5ä¸ªæŸ±å­ï¼ˆä¸‹æ ‡2åˆ°4ï¼‰ï¼Œé«˜åº¦ä¸º2ï¼Œé¢ç§¯ä¸º2*3=6ã€‚
å®é™…ä¸Šæœ€å¤§é¢ç§¯æ˜¯ç¬¬2åˆ°ç¬¬5ä¸ªæŸ±å­ï¼ˆä¸‹æ ‡1åˆ°4ï¼‰ï¼Œé«˜åº¦ä¸º2ï¼Œé¢ç§¯ä¸º2*4=8ã€‚
ç­‰ç­‰ï¼Œå®é™…ä¸Šåº”è¯¥æ˜¯ç¬¬3ä¸ªæŸ±å­ï¼ˆé«˜åº¦5ï¼‰å’Œç¬¬4ä¸ªæŸ±å­ï¼ˆé«˜åº¦6ï¼‰ï¼Œé¢ç§¯ä¸º5*1=5ã€‚
ç­‰ç­‰ï¼Œç­‰ç­‰ã€‚å®é™…ä¸Šåº”è¯¥æ˜¯ç¬¬2ã€3ã€4ã€5ä¸ªæŸ±å­ï¼ˆä¸‹æ ‡1-4ï¼‰ï¼Œé«˜åº¦å–min(1,5,6,2)=1ï¼Œé¢ç§¯ä¸º1*4=4ã€‚
å®é™…ä¸Šåº”è¯¥æ˜¯ç¬¬3ã€4ä¸ªæŸ±å­ï¼ˆä¸‹æ ‡2-3ï¼‰ï¼Œé«˜åº¦å–min(5,6)=5ï¼Œé¢ç§¯ä¸º5*2=10ã€‚
```

**æœ€ç®€å•å®ç°ï¼š**

```python
def largestRectangleArea(heights):
    """
    æŸ±çŠ¶å›¾ä¸­æœ€å¤§çš„çŸ©å½¢ï¼šä½¿ç”¨å•è°ƒæ ˆ
    
    æ€è·¯ï¼š
    1. ä½¿ç”¨å•è°ƒé€’å¢æ ˆï¼Œå­˜å‚¨æŸ±å­çš„ç´¢å¼•
    2. éå†æ¯ä¸ªæŸ±å­ï¼š
       - å½“é‡åˆ°æ›´å°çš„æŸ±å­æ—¶ï¼Œè®¡ç®—ä»¥æ ˆé¡¶ä¸ºé«˜çš„çŸ©å½¢é¢ç§¯
       - å‡ºæ ˆï¼Œç»§ç»­è®¡ç®—
    3. å¤„ç†å‰©ä½™æ ˆä¸­çš„æŸ±å­
    
    æ—¶é—´å¤æ‚åº¦ï¼šO(n)
    ç©ºé—´å¤æ‚åº¦ï¼šO(n)
    """
    n = len(heights)
    stack = []  # å•è°ƒé€’å¢æ ˆï¼Œå­˜å‚¨ç´¢å¼•
    max_area = 0
    
    # éå†æ‰€æœ‰æŸ±å­ï¼ŒåŠ ä¸Šå“¨å…µ
    for i in range(n + 1):
        # å½“å‰é«˜åº¦ï¼ˆæœ€åä¸€ä¸ªç”¨0ä½œä¸ºå“¨å…µï¼‰
        current_height = heights[i] if i < n else 0
        
        # å½“æ ˆä¸ä¸ºç©ºä¸”å½“å‰é«˜åº¦ < æ ˆé¡¶é«˜åº¦
        while stack and current_height < heights[stack[-1]]:
            # è®¡ç®—ä»¥æ ˆé¡¶ä¸ºé«˜çš„çŸ©å½¢é¢ç§¯
            height = heights[stack.pop()]
            # å®½åº¦ = å½“å‰ä½ç½® - æ–°çš„æ ˆé¡¶ - 1
            width = i if not stack else i - stack[-1] - 1
            max_area = max(max_area, height * width)
        
        stack.append(i)
    
    return max_area

# æµ‹è¯•ç”¨ä¾‹
print(largestRectangleArea([2,1,5,6,2,3]))  # è¾“å‡º: 10
print(largestRectangleArea([2,4]))           # è¾“å‡º: 4
print(largestRectangleArea([1,1]))           # è¾“å‡º: 2
```

**è§£é¢˜æ€è·¯è¯¦è§£ï¼š**

è¿™é“é¢˜çš„æ ¸å¿ƒæ˜¯ä½¿ç”¨**å•è°ƒæ ˆ**ï¼š

**æ ¸å¿ƒåŸç†ï¼š**
- å•è°ƒé€’å¢æ ˆç»´æŠ¤æŸ±å­é«˜åº¦é€’å¢çš„ç´¢å¼•
- å½“é‡åˆ°æ›´å°çš„æŸ±å­æ—¶ï¼Œè®¡ç®—ä»¥å¼¹å‡ºæŸ±å­ä¸ºé«˜çš„çŸ©å½¢é¢ç§¯
- çŸ©å½¢å®½åº¦ = å½“å‰ä½ç½® - æ–°çš„æ ˆé¡¶ - 1

**ç®—æ³•æµç¨‹ï¼š**
1. ä½¿ç”¨å•è°ƒé€’å¢æ ˆï¼Œæ·»åŠ å“¨å…µå¤„ç†è¾¹ç•Œ
2. éå†æ¯ä¸ªæŸ±å­ï¼š
   - å½“å½“å‰é«˜åº¦ < æ ˆé¡¶é«˜åº¦æ—¶ï¼Œå¼¹å‡ºæ ˆé¡¶
   - è®¡ç®—çŸ©å½¢é¢ç§¯ï¼šheight Ã— width
   - width = å½“å‰ä½ç½® - æ–°çš„æ ˆé¡¶ - 1
3. å¤„ç†æ ˆä¸­å‰©ä½™çš„æŸ±å­

**ä¸¾ä¾‹è¯´æ˜ï¼š**
```
heights = [2,1,5,6,2,3]

i=0: 2å…¥æ ˆï¼Œstack=[0]
i=1: 1 < 2ï¼Œå¼¹å‡º0ï¼Œè®¡ç®—é¢ç§¯2*(1-(-1)-1)=2*1=2ï¼Œmax_area=2
     1å…¥æ ˆï¼Œstack=[1]
i=2: 5 > 1ï¼Œ5å…¥æ ˆï¼Œstack=[1,2]
i=3: 6 > 5ï¼Œ6å…¥æ ˆï¼Œstack=[1,2,3]
i=4: 2 < 6ï¼Œå¼¹å‡º3ï¼Œè®¡ç®—é¢ç§¯6*(4-2-1)=6*1=6ï¼Œmax_area=6
     2 < 5ï¼Œå¼¹å‡º2ï¼Œè®¡ç®—é¢ç§¯5*(4-1-1)=5*2=10ï¼Œmax_area=10
     2 > 1ï¼Œ2å…¥æ ˆï¼Œstack=[1,4]
i=5: 3 > 2ï¼Œ3å…¥æ ˆï¼Œstack=[1,4,5]
i=6: 0 < 3ï¼Œå¼¹å‡º5ï¼Œè®¡ç®—é¢ç§¯3*(6-4-1)=3*1=3ï¼Œmax_area=10
     0 < 2ï¼Œå¼¹å‡º4ï¼Œè®¡ç®—é¢ç§¯2*(6-1-1)=2*4=8ï¼Œmax_area=10
     0 < 1ï¼Œå¼¹å‡º1ï¼Œè®¡ç®—é¢ç§¯1*(6-(-1)-1)=1*6=6ï¼Œmax_area=10

æœ€ç»ˆç»“æœï¼š10 âœ“
```

**æ—¶é—´å¤æ‚åº¦è¯æ˜ï¼š**
- æ¯ä¸ªæŸ±å­æœ€å¤šå…¥æ ˆå‡ºæ ˆä¸€æ¬¡ï¼šO(n)
- æ€»å¤æ‚åº¦ï¼šO(n)

---

## ğŸ¯ æ ˆè§£é¢˜æŠ€å·§æ€»ç»“

### 1. æ ˆçš„åŸºæœ¬æ“ä½œæ¨¡æ¿
```python
# Pythonåˆ—è¡¨ä½œä¸ºæ ˆ
stack = []
stack.append(x)  # å…¥æ ˆ
x = stack.pop()  # å‡ºæ ˆ
x = stack[-1]    # æŸ¥çœ‹æ ˆé¡¶
is_empty = len(stack) == 0
```

### 2. å•è°ƒæ ˆæ¨¡æ¿
```python
# å•è°ƒé€’å¢æ ˆï¼ˆå¯»æ‰¾ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ ï¼‰
def next_greater_element(nums):
    stack = []
    result = [-1] * len(nums)
    
    for i in range(len(nums)):
        while stack and nums[i] > nums[stack[-1]]:
            prev_index = stack.pop()
            result[prev_index] = nums[i]
        stack.append(i)
    
    return result

# å•è°ƒé€’å‡æ ˆï¼ˆå¯»æ‰¾ä¸‹ä¸€ä¸ªæ›´å°å…ƒç´ ï¼‰
def next_smaller_element(nums):
    stack = []
    result = [-1] * len(nums)
    
    for i in range(len(nums)):
        while stack and nums[i] < nums[stack[-1]]:
            prev_index = stack.pop()
            result[prev_index] = nums[i]
        stack.append(i)
    
    return result
```

### 3. æ‹¬å·åŒ¹é…æ¨¡æ¿
```python
def is_valid_brackets(s):
    bracket_map = {')': '(', '}': '{', ']': '['}
    stack = []
    
    for char in s:
        if char in bracket_map:
            if not stack or stack[-1] != bracket_map[char]:
                return False
            stack.pop()
        else:
            stack.append(char)
    
    return len(stack) == 0
```

æ ˆæ˜¯è§£å†³è®¸å¤šè®¡ç®—æœºç§‘å­¦é—®é¢˜çš„å¼ºå¤§å·¥å…·ï¼ŒæŒæ¡å•è°ƒæ ˆã€æ‹¬å·åŒ¹é…ç­‰æŠ€å·§å¯ä»¥é«˜æ•ˆè§£å†³å„ç±»é—®é¢˜ã€‚